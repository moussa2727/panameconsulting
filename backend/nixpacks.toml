[phases.setup]
cmds = [
  "corepack enable",
  "corepack prepare pnpm@latest --activate"
]

[phases.install]
cmds = ["pnpm install --frozen-lockfile"]
cacheDirectories = [
  "/root/.local/share/pnpm/store"
]

[phases.build]
cmds = ["pnpm run build"]

[start]
cmd = "node dist/main.js"

[env]
PORT = "10000"
NODE_ENV = "production"

[build.env]
NODE_ENV = "production"

# Variables requises pour le build
[build.vars]
NODE_ENV = "production"

# Planification pour Node.js
[plan.providers]
node = "18"

# Définition des variables d'environnement nécessaires
[plan.environment]
NODE_ENV = "production"
PORT = "10000"